# ALSA configuration for Seeed 2-Mic HAT (ReSpeaker v2.x)
# Hardware: seeed2micvoicec (playback + capture)
#
# This config provides abstract device names that applications should use:
#   - lelamp_playback: For audio output (livekit, spotifyd, sox, etc.)
#   - lelamp_capture: For microphone input (livekit, VAD, recording, etc.)
#
# Uses dmix for playback and dsnoop for capture to allow multiple apps

# Set lelamp abstract devices as system defaults
pcm.!default {
    type asym
    playback.pcm "lelamp_playback"
    capture.pcm "lelamp_capture"
}

ctl.!default {
    type hw
    card seeed2micvoicec
}

# ==============================================================================
# ABSTRACT DEVICE LAYER - Applications should use these device names
# ==============================================================================

# lelamp_playback - Abstract playback device (use this in all applications)
pcm.lelamp_playback {
    type plug
    slave.pcm "hw_playback_dmix"
}

# lelamp_capture - Abstract capture device (use this in all applications)
pcm.lelamp_capture {
    type plug
    slave.pcm "hw_capture_dsnoop"
}

# ==============================================================================
# HARDWARE LAYER - Maps abstract devices to physical hardware
# ==============================================================================

# Hardware playback - Seeed 2-Mic with dmix for sharing
pcm.hw_playback_dmix {
    type dmix
    ipc_key 1024
    ipc_perm 0666
    slave {
        pcm {
            type hw
            card seeed2micvoicec
            device 0
        }
        rate 48000
        channels 2
        period_time 0
        period_size 1024
        buffer_size 4096
    }
    bindings {
        0 0
        1 1
    }
}

# Hardware capture - Seeed 2-Mic with dsnoop for sharing
pcm.hw_capture_dsnoop {
    type dsnoop
    ipc_key 1025
    ipc_perm 0666
    slave {
        pcm {
            type hw
            card seeed2micvoicec
            device 0
        }
        rate 48000
        channels 2
        period_size 1024
        buffer_size 4096
    }
    bindings {
        0 0
        1 1
    }
}
