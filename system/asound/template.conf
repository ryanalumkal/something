# ALSA configuration for LeLamp
# Auto-generated from template
# Playback: {{PLAYBACK_NAME}}
# Capture: {{CAPTURE_NAME}}
#
# This config provides abstract device names that applications should use:
#   - lelamp_playback: For audio output (livekit, spotifyd, sox, etc.)
#   - lelamp_capture: For microphone input (livekit, VAD, recording, etc.)
#
# Uses dmix for playback{{CAPTURE_DSNOOP_COMMENT}}

# Set lelamp abstract devices as system defaults
pcm.!default {
    type asym
    playback.pcm "lelamp_playback"
    capture.pcm "lelamp_capture"
}

ctl.!default {
    type hw
    card {{PLAYBACK_CARD}}
}

# ==============================================================================
# ABSTRACT DEVICE LAYER - Applications should use these device names
# ==============================================================================

# lelamp_playback - Abstract playback device (use this in all applications)
pcm.lelamp_playback {
    type plug
    slave.pcm "hw_playback_dmix"
}

# lelamp_capture - Abstract capture device (use this in all applications)
pcm.lelamp_capture {
    type plug
    slave.pcm "hw_capture{{CAPTURE_DSNOOP_SUFFIX}}"
}

# ==============================================================================
# HARDWARE LAYER - Maps abstract devices to physical hardware
# ==============================================================================

# Hardware playback - {{PLAYBACK_NAME}} with dmix for sharing
pcm.hw_playback_dmix {
    type dmix
    ipc_key 1024
    ipc_perm 0666
    slave {
        pcm {
            type hw
            card {{PLAYBACK_CARD}}
            device {{PLAYBACK_DEVICE}}
        }
        rate {{PLAYBACK_RATE}}
        channels {{PLAYBACK_CHANNELS}}
        period_time 0
        period_size 1024
        buffer_size 4096
    }
    bindings {
        0 0
        1 1
    }
}

# Hardware capture - {{CAPTURE_NAME}}{{CAPTURE_DSNOOP_COMMENT}}
{{CAPTURE_DSNOOP_BLOCK}}
